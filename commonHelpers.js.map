{"version":3,"file":"commonHelpers.js","sources":["../src/js/main.js"],"sourcesContent":["import messages from '../message-data.json';\n\nconst messagesList = document.querySelector('.messages');\nconst scrollToBottomBtn = document.querySelector('.scroll-to-bottom-btn');\n\nlet currentState = 0;\nconst messagesLength = messages.length;\n\nfunction renderMessage(message) {\n  const now = new Date();\n  const hours = now.getHours();\n  const minutes = now.getMinutes();\n  const timeString = `${hours.toString().padStart(2, '0')}:${minutes\n    .toString()\n    .padStart(2, '0')}`;\n\n  if (message.type === 'message') {\n    messagesList.insertAdjacentHTML(\n      'beforeend',\n      `<div class=\"message\"><svg class=\"message-tail\" width=\"17\" height=\"21\"><use href=\"./img/icons.svg#tail\"></use></svg><p class=\"message-text\">${message.message}</p><p class=\"message-time\">${timeString}</p></div>`\n    );\n  }\n\n  if (message.type === 'question') {\n    const answerBtns = message.options\n      .map(btn => {\n        return `<button class=\"answer-button\" type=\"button\" data-id=\"${btn.id}\">${btn.label}</button>`;\n      })\n      .join('');\n    messagesList.insertAdjacentHTML(\n      'beforeend',\n      `<div class=\"message\"><svg class=\"message-tail\" width=\"17\" height=\"21\"><use href=\"./img/icons.svg#tail\"></use></svg><p class=\"message-text question\">${message.message}</p><p class=\"message-time\">${timeString}</p></div><div class=\"answer-buttons-wrap\">${answerBtns}</div>`\n    );\n\n    const answerButtons = document.querySelectorAll('.answer-button');\n    answerButtons.forEach(button => {\n      button.addEventListener('click', handleAnswerClick);\n    });\n  }\n}\n\nfunction handleAnswerClick(event) {\n  const answerId = event.target.dataset.id;\n  const currentMessage = messages[currentState];\n  const nextMessageId = currentMessage.next[answerId];\n  const nextMessage = messages.find(message => message.id === nextMessageId);\n\n  messagesList.insertAdjacentHTML(\n    'beforeend',\n    `<div class=\"response\"><p class=\"message-text\">${event.target.textContent}</p><svg class=\"response-tail\" width=\"17\" height=\"21\"><use href=\"./img/icons.svg#tail\"></use></svg></div>`\n  );\n\n  const currentQuestion = event.target.closest('.answer-buttons-wrap');\n  const answerButtons = currentQuestion.querySelectorAll('.answer-button');\n\n  answerButtons.forEach(button => {\n    button.disabled = true;\n  });\n\n  if (nextMessage) {\n    currentState = messages.indexOf(nextMessage);\n    renderMessage(nextMessage);\n  }\n\n  if (nextMessageId === 7) {\n    setTimeout(() => {\n      renderTable();\n    }, 1000);\n  }\n}\n\nfunction init() {\n  setTimeout(() => {\n    messagesList.insertAdjacentHTML(\n      'afterbegin',\n      '<p class=\"date animate__backInUp\">Сьогодні</p>'\n    );\n  }, 700);\n\n  let delay = 1000;\n\n  for (let i = 0; i < messagesLength; i++) {\n    const message = messages[i];\n\n    if (message.type === 'question') {\n      setTimeout(() => {\n        currentState = i;\n        renderMessage(message);\n      }, delay);\n      break;\n    } else {\n      setTimeout(() => {\n        renderMessage(message);\n      }, delay);\n      delay += 1000;\n    }\n  }\n\n  messagesList.addEventListener('scroll', () => {\n    if (\n      messagesList.scrollTop + messagesList.clientHeight <\n      messagesList.scrollHeight\n    ) {\n      scrollToBottomBtn.classList.add('show');\n    } else {\n      scrollToBottomBtn.classList.remove('show');\n    }\n  });\n\n  scrollToBottomBtn.addEventListener('click', () => {\n    messagesList.scrollTop = messagesList.scrollHeight;\n  });\n}\n\nfunction renderTable() {\n  messagesList.insertAdjacentHTML(\n    'beforeend',\n    '<div class=\"message\"><svg class=\"message-tail\" width=\"17\" height=\"21\"><use href=\"./img/icons.svg#tail\"></use></svg><form class=\"form\"><input type=\"text\" name=\"name\" id=\"name\" class=\"form-input\" placeholder=\"Імʼя\" required minlength=\"2\" maxlength=\"50\"/><input type=\"text\" name=\"surname\" id=\"surname\" class=\"form-input\" placeholder=\"Прізвище\" required minlength=\"2\" maxlength=\"50\"/><input type=\"email\" name=\"email\" id=\"email\" class=\"form-input\" placeholder=\"Email\" required/><input type=\"tel\" name=\"phone\" id=\"phone\" class=\"form-input\" placeholder=\"Телефон\" required minlength=\"2\" maxlength=\"50\"/><button type=\"submit\" class=\"form-submit-btn\">Надіслати</button></form></div>'\n  );\n}\n\nfunction checkForm() {\n  const form = document.querySelector('.form');\n  const phoneRegex = /^\\+?(\\d[\\d-.()\\s]*){7,}$/;\n\n  if (form) {\n    let dataObj = {};\n    form.addEventListener('submit', e => {\n      e.preventDefault();\n      const formData = new FormData(form);\n      for (const [key, value] of formData) {\n        dataObj[key] = value;\n      }\n\n      const phoneNumber = dataObj['phone'];\n\n      if (!phoneRegex.test(phoneNumber)) {\n        alert('Please enter a valid phone number');\n        return;\n      }\n\n      sessionStorage.setItem('dataObj', JSON.stringify(dataObj));\n      form.reset();\n      window.location.href = 'thanks.html';\n    });\n\n    clearInterval(intervalId);\n  }\n}\n\nconst intervalId = setInterval(checkForm, 1000);\n\ninit();\n\nconst observer = new MutationObserver(() => {\n  messagesList.scrollTop =\n    messagesList.scrollHeight - messagesList.clientHeight;\n  messagesList.scrollTo({ top: messagesList.scrollHeight, behavior: 'smooth' });\n});\n\nobserver.observe(messagesList, { childList: true });\n"],"names":["messagesList","scrollToBottomBtn","currentState","messagesLength","messages","renderMessage","message","now","hours","minutes","timeString","answerBtns","btn","button","handleAnswerClick","event","answerId","nextMessageId","nextMessage","renderTable","init","delay","i","checkForm","form","phoneRegex","dataObj","e","formData","key","value","phoneNumber","intervalId","observer"],"mappings":"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"}